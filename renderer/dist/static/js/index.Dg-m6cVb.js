import{_ as e,C as a,S as l,G as o,i as t,d as r}from"./index.ByAAvK4v.js";import{j as n}from"./vendor-utils.GQMQj4-C.js";import{m as s,B as i,M as d,g as u}from"./vendor-ui.DGEqNazO.js";import{r as c,a0 as p,a1 as v,a2 as f,a6 as m,B as y,u as g,ad as h,M as j,F as S,c as T}from"./vendor-core.C0Lh0Bwd.js";import"./vendor-pdf-lib.BXU7dqtn.js";import"./vendor-chart.NpQzHG3K.js";import"./vendor-calendar.Dr9D_D2E.js";import"./vendor-office.DzQU5JIL.js";import"./vendor-pdf-dist.DMQtNH0k.js";import"./vendor-excel.zAN2rvz7.js";import"./vendor-code-editor.DyVN5M6D.js";import"./vendor-editor.DQiCmevo.js";import"./vue3-lib.32gCSs7p.js";import"./vendor-docx.oM3BbWsc.js";const _={class:"toolbar"},b={class:"left-container"},w={key:0,class:"right-actions"},C=e({__name:"tool-bar",props:{mode:{type:String,default:"page"}},emits:["filterChange"],setup(e,{emit:r}){const T=c(null),C=c({name:"",relateId:"",tagId:"",cardType:"",subType:"",sortType:"updateTime_desc"}),k=r,M=n((()=>{k("filterChange",C.value)}),600),x=()=>{d.confirm({title:"确认清空回收站",content:"确认要清空回收站吗，清空后将不可恢复？",onOk:()=>{window.top.cardApi.clearRecycle(),u.success("清空回收站成功"),M()}})},z=async e=>{const a=e.target.files;if(a){o.start("数据导入中...");for(const e of a)await t(e);M(),o.done()}},R=e=>{const a=["pdf","video","audio","img","pdf-mark","video-mark","audio-mark","card-mark"],l=e.filter((e=>a.includes(e)));l.length>0?C.value.subType=l.join(","):C.value.subType="";const o=e.filter((e=>!a.includes(e)));C.value.cardType=o.join(","),M()};return(o,t)=>{const r=s,n=i;return v(),p(S,null,[f("div",_,[f("div",b,[y(r,{style:{width:"200px"},type:"text",allowClear:"","enter-button":"",placeholder:"模糊搜索卡片...",value:C.value.name,"onUpdate:value":t[0]||(t[0]=e=>C.value.name=e),onSearch:g(M)},null,8,["value","onSearch"]),y(g(a),{onChange:R}),y(g(l),{sortType:C.value.sortType,"onUpdate:sortType":t[1]||(t[1]=e=>C.value.sortType=e),onChange:g(M)},null,8,["sortType","onChange"])]),"right"!==e.mode?(v(),p("div",w,[y(n,{danger:"",onClick:x},{default:h((()=>t[2]||(t[2]=[j("清空回收站")]))),_:1})])):m("",!0)]),f("input",{type:"file",ref_key:"fileInput",ref:T,multiple:"",style:{display:"none"},onChange:z},null,544)],64)}}},[["__scopeId","data-v-e8929251"]]),k={class:"card-lib-container"},M=e({__name:"index",props:{cardSize:{type:Number,default:220}},setup(e){const a=c(!1),l=c(!1),o=c({}),t=c(1),n=c(30),s=c(!0),i=c(0),d=c(null),u=c([]),f=async e=>{o.value=e,t.value=1,a.value=!0;try{const a=await window.top.cardApi.findRecyclePage({...e,page:t.value,pageSize:n.value});d.value.resetScrollTop(),u.value=a.list,i.value=a.total||0,s.value=u.value.length<i.value}catch(l){}finally{a.value=!1}},m=async()=>{if(s.value&&!a.value){t.value++,l.value=!0;try{const e=(await window.top.cardApi.findRecyclePage({...o.value,page:t.value,pageSize:n.value})).list;u.value=[...u.value,...e],s.value=u.value.length<i.value}catch(e){t.value--}finally{l.value=!1}}};return T((()=>{f({})})),(t,n)=>{const i=r;return v(),p("div",k,[y(C,{onFilterChange:f}),y(i,{ref_key:"cardListRef",ref:d,cards:u.value,loading:a.value,loadingMore:l.value,"onUpdate:loadingMore":n[0]||(n[0]=e=>l.value=e),cardSize:e.cardSize,isSelect:!1,hasMore:s.value,isRecycle:!0,onRefresh:n[1]||(n[1]=e=>f(o.value)),onLoadMore:m,onSelect:t.handleSelect},null,8,["cards","loading","loadingMore","cardSize","hasMore","onSelect"])])}}},[["__scopeId","data-v-92253f2b"]]);export{M as default};
