import{_ as e,f as a,b as o,g as t,h as r,E as i}from"./index.ByAAvK4v.js";import{r as n,ar as s,c as d,v as l,a0 as c,a1 as u,a2 as p,a3 as v,u as m,ac as w,a6 as g,B as f}from"./vendor-core.C0Lh0Bwd.js";import{v as y}from"./vendor-utils.GQMQj4-C.js";import{g as h}from"./vendor-ui.DGEqNazO.js";import"./vendor-pdf-lib.BXU7dqtn.js";import"./vendor-chart.NpQzHG3K.js";import"./vendor-calendar.Dr9D_D2E.js";import"./vendor-office.DzQU5JIL.js";import"./vendor-pdf-dist.DMQtNH0k.js";import"./vendor-excel.zAN2rvz7.js";import"./vendor-code-editor.DyVN5M6D.js";import"./vendor-editor.DQiCmevo.js";import"./vue3-lib.32gCSs7p.js";import"./vendor-docx.oM3BbWsc.js";const k={class:"window-layout"},b={class:"window-toolbar"},x={class:"window-toolbar-right"},C={key:2,class:"window-toolbar-icon-group"},j={class:"router-view-layout"},S=e({__name:"index",setup(e){const{uploadFileMethod:S,beforeUpload:O,previewUrl:q}=t(),J=n({id:y(),cardType:"card",content:null,name:""}),M=()=>{J.value.isCreate=!1,J.value.id=y(),J.value.cardType="card",J.value.content=null,J.value.name=""},N=s(),T=()=>{window.top.systemApi.closeChildWindow()},U=()=>{const e=N.query.cardType,a=N.query.subType;return["video-mark","audio-mark","pdf-mark","card-mark","video","audio","pdf"].includes(a)?a:e},L=async()=>{var e,a;J.value.isCreate?await window.top.cardApi.update(J.value.id,JSON.parse(JSON.stringify({...J.value,content:J.value.content?JSON.stringify(J.value.content):null}))):await window.top.cardApi.create(JSON.parse(JSON.stringify({...J.value,content:J.value.content?JSON.stringify(J.value.content):null}))),J.value.isCreate=!0,null==(a=null==(e=window.events)?void 0:e.broadcast)||a.call(e,"card:list:refresh",{source:"renderer",at:Date.now()}),F(),h.success("保存成功")},I=e=>{},_=e=>{J.value.content=e.content,J.value.extraData=e.coverContent?JSON.stringify(e.coverContent):null,J.value.text=e.text,F()},F=()=>{localStorage.setItem("rebirth-temp-cardInfo",JSON.stringify(J.value))};return d((()=>{N.query.id||(()=>{const e=localStorage.getItem("rebirth-temp-cardInfo");e&&(J.value=JSON.parse(e))})()})),l((()=>N.query),(()=>{const e=N.query.id,a=N.query.cardType;e&&a&&(J.value.id=e,J.value.cardType=a)}),{immediate:!0,deep:!0}),(e,t)=>{const n=o;return u(),c("div",k,[p("div",b,[p("div",{class:"window-toolbar-left",style:v({"padding-left":m(a)()?"64px":"10px"})},t[0]||(t[0]=[p("div",{class:"logo"},[p("img",{class:"logo-img",src:"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='40'%20height='40'%20viewBox='0%200%2040%2040'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20Re字母组合%20--%3e%3cg%20transform='translate(8,8)'%3e%3c!--%20R字母%20--%3e%3cpath%20d='M0,0%20L0,24%20M0,0%20L12,0%20M12,0%20L12,12%20M0,12%20L12,12%20M4,12%20L14,24'%20stroke='%231a1a1a'%20stroke-width='4'%20stroke-linecap='round'%20fill='none'/%3e%3c!--%20e字母%20-%20完整的小写，下方不闭合%20--%3e%3cg%20transform='translate(22,16)%20rotate(18)'%3e%3c!--%20上半部分圆弧和右侧%20--%3e%3cpath%20d='M-6,0%20C-6,-3.3%20-3.3,-6%200,-6%20C3.3,-6%206,-3.3%206,0'%20stroke='%231a1a1a'%20stroke-width='4'%20stroke-linecap='round'%20fill='none'/%3e%3c!--%20左侧竖线%20--%3e%3cpath%20d='M-6,0%20C-6,3.3%20-3.3,6%200,6'%20stroke='%231a1a1a'%20stroke-width='4'%20stroke-linecap='round'%20fill='none'/%3e%3c!--%20中间的横线%20--%3e%3cpath%20d='M-6,0%20L6,0'%20stroke='%231a1a1a'%20stroke-width='4'%20stroke-linecap='round'%20fill='none'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",alt:"logo"})],-1)]),4),p("div",x,[m(N).query.id?g("",!0):(u(),w(n,{key:0,style:{"margin-right":"10px"},class:"window-toolbar-icon",onClick:M,name:"editor-add"})),m(N).query.id?g("",!0):(u(),w(n,{key:1,style:{"margin-right":"10px"},class:"window-toolbar-icon",onClick:L,name:"editor-save"})),m(a)()?g("",!0):(u(),c("div",C,[f(n,{class:"window-toolbar-icon",name:"window-close",onClick:T})]))])]),p("div",j,[m(N).query.id?(u(),w(m(i),{key:1,type:U(),id:m(J).id,mode:"right"},null,8,["type","id"])):(u(),w(m(r),{key:0,id:e.id,ref:"editorRef",editorContent:m(J).content,uploadFile:m(S),beforeUpload:m(O),previewUrl:m(q),name:m(J).name,onOutlineChange:I,onChange:_},null,8,["id","editorContent","uploadFile","beforeUpload","previewUrl","name"]))])])}}},[["__scopeId","data-v-5a572236"]]);export{S as default};
